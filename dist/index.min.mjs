import{defineComponent as e,h as t}from"vue";import{FmmFormHTML as s,Fmm as r,FmmStoreImpl as o}from"@eafmm/core";const i=e({methods:{destructor(){var e;return null===(e=h.MINIMAPS.get(this))||void 0===e?void 0:e.destructor()},takeSnapshot(){var e;return null===(e=h.MINIMAPS.get(this))||void 0===e?void 0:e.takeSnapshot()}},mounted(){var e,t;if(Object.keys(this.$slots).length)throw new Error("FmmVueMinimap is a contentless tag");let o=null===(e=this.$el)||void 0===e?void 0:e.parentElement;for(;o&&"FORM"!==o.tagName;)o=o.parentElement;if(!o)throw new Error("FmmVueMinimap must be used inside a FORM tag");const i={aggregateLabels:this.aggregateLabels,anchor:this.anchor,debounceMsec:this.debounceMsec,dynamicLabels:this.dynamicLabels,form:new s(o,this.page),framework:this.framework,onUpdate:e=>this.$emit("update",e),store:this.store,title:this.title,usePanelDetail:this.usePanelDetail,useWidthToScale:this.useWidthToScale,verbosity:this.verbosity,zoomFactor:this.zoomFactor},n=this.panel?null===(t=h.PANELS.get(this.panel))||void 0===t?void 0:t.createMinimap(i):r.createMinimap(i,this.parent);n&&(h.MINIMAPS.set(this,n),n.compose(this.customElementIds),this.$watch("customElementIds",(e=>n.compose(e))))},name:"FmmVueMinimap",props:{aggregateLabels:Object,anchor:HTMLDivElement,customElementIds:Array,debounceMsec:Number,dynamicLabels:Array,framework:Object,page:HTMLDivElement,panel:{type:Object,validator:e=>"FmmVuePanel"===e.$options.name},parent:HTMLDivElement,store:Object,title:{required:!0,type:String,validator:e=>(null==e?void 0:e.trim().length)>0},usePanelDetail:Boolean,useWidthToScale:Boolean,verbosity:Number,zoomFactor:Number},render:()=>t("div"),unmounted(){const e=h.MINIMAPS.get(this);e&&e.detach(),h.MINIMAPS.delete(this)},updated(){this.$nextTick((()=>{var e;return null===(e=h.MINIMAPS.get(this))||void 0===e?void 0:e.takeSnapshot()}))}}),n=e({methods:{destroyDetached(){const e=h.PANELS.get(this);e&&e.destroyDetached()}},mounted(){if(Object.keys(this.$slots).length)throw new Error("FmmVuePanel is a contentless tag");h.PANELS.set(this,r.createPanel(this.$el,this.detailParent,this.vertical))},name:"FmmVuePanel",props:{detailParent:HTMLDivElement,vertical:Boolean},render:()=>t("div",{class:"fmm-panel"},[t("style",{tag:"component",attrs:{type:"text/css"}},r.CSS)]),unmounted(){const e=h.PANELS.get(this);e&&e.destructor(),h.PANELS.delete(this)}}),a=e({data:()=>({store:void 0}),emits:["store"],mounted(){if(Object.keys(this.$slots).length)throw new Error("FmmVueStore is a contentless tag");this.$emit("store",this.store=new o(this.values,this.errors))},name:"FmmVueStore",props:{errors:Object,values:{required:!0,type:Object}},render:()=>null,watch:{errors:function(){this.store.update(this.values,this.errors)},values:function(){this.store.update(this.values,this.errors)}}}),l=e({data:()=>({$store:void 0,unsubscribeToStore:void 0,store:void 0}),emits:["store"],mounted(){if(Object.keys(this.$slots).length)throw new Error("FmmVuex is a contentless tag");this.$emit("store",this.store=new o(this.$store.state,this.errors)),this.unsubscribeToStore=this.$store.subscribe(((e,t)=>this.store.update(t,this.errors)))},name:"FmmVuex",props:{errors:Object},render:()=>null,unmounted(){this.unsubscribeToStore()},watch:{errors:function(){this.store.update(this.$store.state,this.errors)}}}),h={MINIMAPS:new WeakMap,PANELS:new WeakMap},m={createFrameworkItem(e,t){var s;return(null===(s=t.parentElement)||void 0===s?void 0:s.classList.contains("v-select__selections"))?new c(t):new u(t)}};class u{constructor(e){const t="INPUT"===e.tagName&&"radio"===e.type;let s=e.parentElement;const r=t?"v-radio":"v-input";for(;s&&!s.classList.contains(r);)s=s.parentElement;if(s){this.envelope=s;const e=s.querySelectorAll("LABEL");if(1===e.length&&(this.label=e[0]),t)for(;s&&!s.classList.contains("v-input--radio-group");)s=s.parentElement;this.forValidation=s||this.envelope}else this.envelope=this.forValidation=e}destructor(){}getEnvelope(e,t,s){return this.envelope}getError(e,t,s,r){var o;return(null===(o=this.forValidation.querySelector("DIV.v-messages__message"))||void 0===o?void 0:o.textContent)||""}getLabel(e,t){return this.label}getValue(e,t,s,r){return""}}class c extends u{getValue(e,t,s,r){var o;return(null===(o=t.parentElement)||void 0===o?void 0:o.textContent)||""}}export{i as FmmVueMinimap,n as FmmVuePanel,a as FmmVueStore,m as FmmVuetify,l as FmmVuex};